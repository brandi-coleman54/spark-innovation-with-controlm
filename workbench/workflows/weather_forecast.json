{
    "MY_WEATHER_FORECAST": {
        "Type": "Folder",
        "Variables": [
            {
                "zip_code": "77001"
            },
            {
                "user_home": "${user_home}"
            },
            {
                "base_dir": "${base_dir}"
            },
            {
                "forecast_file": "~/forecast.json"
            }
        ],
        "get_forecast": {
            "Type": "Job:ApplicationIntegrator:AI Weather",
            "Host": "workbench-host",
            "ConnectionProfile": "NONE",
            "AI-Location": "%%zip_code",
            "AI-Temperature Units": "Fahrenheit",
            "AI-Target Path": "%%forecast_file"
        },
        "generate_dashboard": {
            "Type": "Job:Command",
            "Command": ". ~/venv/bin/activate && nohup streamlit run %%user_home/%%base_dir/workbench/scripts/run_weather_dashboard.py -- %%forecast_file --server.headless true --server.address 0.0.0.0 &",
            "Host": "workbench-host",
            "RunAs": "controlm"
        },
        "Flow": {
            "Type": "Flow",
            "Sequence": [
                "get_forecast",
                "generate_dashboard"
            ]
        }
    }
}
