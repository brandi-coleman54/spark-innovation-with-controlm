{
    "Defaults": {
        "Host": "zzz_instruqt_server",
        "ControlmServer": "IN01",
        "RunAs": "controlm",
        "Application": "zzz_whiskey_pipeline",
        "SubApplication": "zzz_process_whiskey_data"
    },
    "zzz_payments": {
        "Type": "Folder",
        "OrderMethod": "Manual",
        "get_payment_data": {
            "Type": "Job:Airflow",
            "ConnectionProfile": "ZZZ_GCP_AIRFLOW",
            "DagId": "product_function"
        },
        "transfer_payment_data": {
            "Type": "Job:FileTransfer",
            "ConnectionProfileSrc": "INSTRUQT_S3",
            "ConnectionProfileDest": "ZZZ_LOCAL_FS",
            "FileTransfers": [
                {
                    "Src": "/data_engineering/payments.csv",
                    "Dest": "/home/controlm/payments.csv",
                    "TransferOption": "SrcToDest",
                    "TransferType": "Binary"
                }
            ],
            "S3BucketName": "ctm-techday-resources"
        },
        "insert_payment_data": {
            "Type": "Job:Database:EmbeddedQuery",
            "ConnectionProfile": "INSTRUQT_MYSQL",
            "OutputSQLOutput": "Y",
            "Query": "use replace-with-usercode_whiskey_retail_shop;\\n\\nLOAD DATA LOCAL INFILE '/home/controlm/payments.csv'\\nINTO TABLE payments\\nFIELDS TERMINATED BY ',' \\n(@col1,@col2,@col3,@col4,@col5,@col6,@col7) set payment_id=@col2, date=@col3, customer_id=@col4, employee_id=@col5, product_id=@col6, price=@col7;\\n\\nDELETE FROM payments\\nWHERE payment_id = 0;"
        },
        "Flow": {
            "Type": "Flow",
            "Sequence": [
                "get_payment_data",
                "transfer_payment_data",
                "insert_payment_data"
            ]
        }
    }
}
