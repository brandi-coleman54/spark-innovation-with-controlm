
{
    "Defaults" : {
		"Host": "replace-with-usercode_instruqt_server",
	  "CreatedBy" : "replace-with-email",
		"ControlmServer": "IN01",
		"Application": "replace-with-usercode_SAP500",
		"SubApplication": "replace-with-usercode_SAP500",
		"OrderMethod": "Manual"
	},
  "replace-with-usercode-SP500-MFT-to-Table-Setup" : {
    "Type" : "Folder",
"BQ_MFT_Job_s3_to_gcs" : {
      "Type" : "Job:FileTransfer",
      "ConnectionProfileSrc" : "replace-with-usercode-uc-S3-CP",
      "ConnectionProfileDest" : "replace-with-usercode-uc-GCS-CP",
      "S3BucketNameSrc" : "gcp-bigquery-source",
      "GCSBucketNameDest" : "sp500-etl",
      "RunAs" : "replace-with-usercode-uc-S3-CP+replace-with-usercode-uc-GCS-CP",
      "Variables" : [ {
        "FTP-LOSTYPE" : "Unix"
      }, {
        "FTP-CONNTYPE1" : "S3"
      }, {
        "FTP-ROSTYPE" : "Unix"
      }, {
        "FTP-CONNTYPE2" : "GCS"
      }, {
        "FTP-CM_VER" : "9.0.00"
      }, {
        "FTP-COMPRESSION11" : "0"
      }, {
        "FTP-COMPRESSION21" : "0"
      }, {
        "FTP-OVERRIDE_WATCH_INTERVAL1" : "0"
      }, {
        "FTP-POSTCMD_ON_FAILURE1" : "0"
      }, {
        "FTP-SYNC_DIR_NO_DEL1" : "0"
      } ],
      "FileTransfers" : [ {
        "TransferType" : "Binary",
        "TransferOption" : "SrcToDest",
        "Src" : "/all_stocks_5yr.csv",
        "Dest" : "/",
        "SRC_PATTERN" : "Wildcard",
        "ABSTIME" : "0",
        "TIMELIMIT" : "0",
        "UNIQUE" : "0",
        "SRCOPT" : "0",
        "IF_EXIST" : "0",
        "DSTOPT" : "0",
        "ContinueOnFailure" : false,
        "DeleteFileOnDestIfFails" : false,
        "FailJobOnDestActionFailure" : false,
        "FailJobOnSourceCommandFailure" : false,
        "FailJobOnDestCommandFailure" : false,
        "RECURSIVE" : "0",
        "EXCLUDE_WILDCARD" : "0",
        "TRIM" : "1",
        "NULLFLDS" : "0",
        "VERNUM" : "0",
        "CASEIFS" : "0",
        "FileWatcherOptions" : {
          "MinDetectedSizeInBytes" : "0",
          "UnitsOfTimeLimit" : "Minutes",
          "SkipToNextFileIfCriteriaNotMatch" : false
        },
        "IncrementalTransfer" : {
          "IncrementalTransferEnabled" : false,
          "MaxModificationAgeForFirstRunEnabled" : false,
          "MaxModificationAgeForFirstRunInHours" : "1"
        },
        "SimultaneousTransfer" : {
          "TransferMultipleFilesSimultaneously" : false
        }
      } ]
        },
      "BQ_Schema_Table_Creation" : {
      "Type" : "Job:GCP BigQuery",
      "ConnectionProfile" : "replace-with-usercode-uc-BQ-CP",
      "Action" : "Query",
      "Run Select Query and Copy to Table" : "unchecked",
      "Query Type" : "SQL Query",
      "Copy Operation Type" : "Copy",
      "Show Load Options" : "unchecked",
      "Project Name" : "sso-gcp-dba-ctm4-pub-cc10274",
      "Dataset Name" : "sp500_dataset",
      "SQL Statement" : "CREATE OR REPLACE TABLE `sso-gcp-dba-ctm4-pub-cc10274.sp500_dataset.sp500_raw` (date DATE, open FLOAT64, high FLOAT64, low FLOAT64, close FLOAT64, volume INT64, Name STRING);",
      "Description" : "This table creates or replaces S&P500_raw table to store raw daily stock data for S&P500 companies including prices, volume, date, and ticker name. It serves as the base table for downstream financial analysis.",
      "RunAs" : "replace-with-usercode-uc-BQ-CP",
      "Variables" : [ {
        "UCM-SOURCE_TABLES" : ""
      }, {
        "UCM-DESTINATION_TABLE" : ""
      }, {
        "UCM-LOAD_OPTION" : ""
      }, {
        "UCM-BUCKET" : ""
      }, {
        "UCM-TABLE_ID" : ""
      }, {
        "UCM-SOURCE_TABLES" : ""
      }, {
        "UCM-DESTINATION_TABLE" : ""
      }, {
        "UCM-LOAD_OPTION" : ""
      }, {
        "UCM-BUCKET" : ""
      }, {
        "UCM-TABLE_ID" : ""
      } ]
  },
      "BQ_Load_data_to_table" : {
      "Type" : "Job:GCP BigQuery",
      "ConnectionProfile" : "replace-with-usercode-uc-BQ-CP",
      "Project Name" : "sso-gcp-dba-ctm4-pub-cc10274",
      "Dataset Name" : "sp500_dataset",
      "Action" : "Load",
      "Run Select Query and Copy to Table" : "unchecked",
      "Copy Operation Type" : "Copy",
      "Destination Table Properties" : "{\"datasetId\": \"sp500_dataset\", \"projectId\": \"sso-gcp-dba-ctm4-pub-cc10274\", \"tableId\": \"sp500_raw\"}",
      "Show Load Options" : "checked",
      "Destination/Source Bucket URIs" : "\"gs://sp500-etl/all_stocks_5yr.csv\"",
      "Load Options" : "\"maxBadRecords\": 10",
      "RunAs" : "replace-with-usercode-uc-BQ-CP",
      "Variables" : [ {
        "UCM-SOURCE_TABLES" : ""
      }, {
        "UCM-TABLE_ID" : ""
      }, {
        "UCM-SOURCE_TABLES" : ""
      }, {
        "UCM-TABLE_ID" : ""
      } ]
   
    },
  "BQ_Clean_Data" : {
      "Type" : "Job:GCP BigQuery",
      "ConnectionProfile" : "replace-with-usercode-uc-BQ-CP",
      "Action" : "Query",
      "Run Select Query and Copy to Table" : "unchecked",
      "Query Type" : "SQL Query",
      "Copy Operation Type" : "Copy",
      "Show Load Options" : "unchecked",
      "Project Name" : "sso-gcp-dba-ctm4-pub-cc10274",
      "Dataset Name" : "sp500_dataset",
      "SQL Statement" : "CREATE OR REPLACE TABLE `sso-gcp-dba-ctm4-pub-cc10274.sp500_dataset.sp500_clean` AS%4ESELECT%4E  DATE(date) AS date,%4E  open,%4E  high,%4E  low,%4E  close,%4E  volume,%4E  Name,%4E  SAFE_DIVIDE(close - open, open) AS daily_return,%4E  AVG(close) OVER (PARTITION BY Name ORDER BY DATE(date) ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,%4E  AVG(close) OVER (PARTITION BY Name ORDER BY DATE(date) ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30,%4E  STDDEV(close) OVER (PARTITION BY Name ORDER BY DATE(date) ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS volatility_7d%4EFROM%4E  `sso-gcp-dba-ctm4-pub-cc10274.sp500_dataset.sp500_raw`;%4E",
      "RunAs" : "replace-with-usercode-uc-BQ-CP",
      "Variables" : [ {
        "UCM-SOURCE_TABLES" : ""
      }, {
        "UCM-DESTINATION_TABLE" : ""
      }, {
        "UCM-LOAD_OPTION" : ""
      }, {
        "UCM-BUCKET" : ""
      }, {
        "UCM-TABLE_ID" : ""
      }, {
        "UCM-SOURCE_TABLES" : ""
      }, {
        "UCM-DESTINATION_TABLE" : ""
      }, {
        "UCM-LOAD_OPTION" : ""
      }, {
        "UCM-BUCKET" : ""
      }, {
        "UCM-TABLE_ID" : ""
      } ]
    },
  "Flow": {
            "Type": "Flow",
            "Sequence": [
                "BQ_MFT_Job_s3_to_gcs",
                "BQ_Schema_Table_Creation",
                "BQ_Load_data_to_table",
                "BQ_Clean_Data"
            ]
        }
}
}
